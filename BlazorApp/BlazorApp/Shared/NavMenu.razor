@inject StoreService service

<Menu Theme="MenuTheme.Light" Mode="MenuMode.Inline" >
    @if (lists == null)
    {
        <span>Loading...</span>
    }
    else
    {
        @foreach (var list in lists)
        {
            <MenuItem Key="@list.Id.ToString()" RouterLink="@list.Id.ToString()" >
                <Icon Type=@(list.Id == "important"?"star":list.Id=="urgent"?"calendar":list.Id=="general"?"block":"unordered-list") Theme="outline" />
                <span class="nav-text">@list.Name</span>
            </MenuItem>
        }
        <MenuItem Key="add" OnClick="()=>openAddDialog=true">
            <Icon Type="plus" Theme="outline" />
            <span class="nav-text">Add list</span>
        </MenuItem>
    }
</Menu>
<Modal
    Title="Adding new list"
    Visible="@openAddDialog"
    OnOk="handleOk"
    OnCancel="handleCancel"
    >
    <Input @bind-Value="newTitle" Class="inputField" />
</Modal>

@code {
    private ICollection<ListDto> lists;

    protected async override Task OnInitializedAsync()
    {
        lists = service.Lists;
        service.PropertyChanged += OnChange;
        await service.LoadLists();
        await base.OnInitializedAsync();
    }

    protected async

    private void OnChange(object? sender, PropertyChangedEventArgs e)
    {
        lists = service.Lists;
        StateHasChanged();
        Console.WriteLine(e.PropertyName);
    }

    private bool collapseNavMenu = true;

    private bool openAddDialog = false;

    private string newTitle;

    private async Task handleOk()
    {
        await service.AddList(new ListDto()
        {
            Name=newTitle
        });
        openAddDialog = false;
        newTitle = null;
    }

    private void handleCancel()
    {
        openAddDialog = false;
    }

    private string NavMenuCssClass => collapseNavMenu ? "collapse" : null;

    private void ToggleNavMenu()
    {
        collapseNavMenu = !collapseNavMenu;
    }
}
